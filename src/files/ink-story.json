{"inkVersion":21,"root":[["\n","\n","\n",["done",{"#f":5,"#n":"g-0"}],null],"done",{"ItemInventory":[["ev","str","^Baking-Pan","/str",{"VAR?":"Inventory"},{"VAR?":"QuestItem.baking_pan"},"?","/ev",{"*":".^.c-0","flg":5},"ev","str","^Strawberries","/str",{"VAR?":"Inventory"},{"VAR?":"QuestItem.strawberries"},"?","/ev",{"*":".^.c-1","flg":5},"ev","str","^Mithren's Book","/str",{"VAR?":"Inventory"},{"VAR?":"QuestItem.mithren_book"},"?","/ev",{"*":".^.c-2","flg":5},"ev","str","^Magic Flute (Reveal)","/str",{"VAR?":"Spells"},{"VAR?":"Melodies.reveal"},"?","/ev",{"*":".^.c-3","flg":5},"ev","str","^Family Heirloom","/str",{"^var":"Inventory","ci":-1},{"VAR?":"QuestItem.family_heirloom"},{"f()":"HasItem"},"/ev",{"*":".^.c-4","flg":5},"ev","str","^Lamp","/str",{"^var":"Inventory","ci":-1},{"VAR?":"UniqueItem.lamp"},{"f()":"HasItem"},"/ev",{"*":".^.c-5","flg":5},"ev","str","^(Nothing to USE)","/str","choiceCnt",0,"==","/ev",{"*":".^.c-6","flg":5},{"c-0":["\n","ev",{"VAR?":"QuestItem.baking_pan"},{"f()":"AddToUseWith"},"pop","/ev","\n",{"->":"continueOnto","var":true},{"#f":5}],"c-1":["\n","ev",{"VAR?":"QuestItem.strawberries"},{"f()":"AddToUseWith"},"pop","/ev","\n",{"->":"continueOnto","var":true},{"#f":5}],"c-2":["\n","ev",{"VAR?":"QuestItem.mithren_book"},{"f()":"AddToUseWith"},"pop","/ev","\n",{"->":"continueOnto","var":true},{"#f":5}],"c-3":["\n","ev",{"VAR?":"Melodies.reveal"},{"f()":"AddToUseWith"},"pop","/ev","\n",{"->":"continueOnto","var":true},{"#f":5}],"c-4":["\n","ev",{"VAR?":"QuestItem.family_heirloom"},{"f()":"AddToUseWith"},"pop","/ev","\n",{"->":"continueOnto","var":true},{"#f":5}],"c-5":["\n","ev",{"VAR?":"UniqueItem.lamp"},{"f()":"AddToUseWith"},"pop","/ev","\n",{"->":"continueOnto","var":true},{"#f":5}],"c-6":["^ ","\n",{"->":"returnTo","var":true},{"#f":5}]}],{"#f":1}],"Learn":[{"temp=":"x"},{"temp=":"facts"},"ev",{"VAR?":"facts"},{"VAR?":"x"},"+",{"temp=":"facts","re":true},"/ev",{"#f":1}],"DidLearn":[{"temp=":"x"},{"temp=":"facts"},"ev",{"VAR?":"facts"},{"VAR?":"x"},"?","/ev","~ret",{"#f":1}],"DidNotLearn":[{"temp=":"x"},{"temp=":"facts"},"ev",{"VAR?":"facts"},{"VAR?":"x"},"!?","/ev","~ret",{"#f":1}],"HasVisited":[{"temp=":"x"},["ev",{"VAR?":"Visited"},{"VAR?":"x"},"!?","/ev",{"->":".^.b","c":true},{"b":["\n","ev",{"VAR?":"Visited"},{"VAR?":"x"},"+",{"VAR=":"Visited","re":true},"/ev",{"->":".^.^.^.2"},null]}],"nop","\n",{"#f":1}],"GetItem":[{"temp=":"item"},{"temp=":"typeOf"},"ev",{"VAR?":"typeOf"},{"VAR?":"item"},"+",{"temp=":"typeOf","re":true},"/ev",{"#f":1}],"UseItem":[{"temp=":"item"},{"temp=":"typeOf"},"ev",{"VAR?":"typeOf"},{"VAR?":"item"},"-",{"temp=":"typeOf","re":true},"/ev",{"#f":1}],"HasItem":[{"temp=":"item"},{"temp=":"typeOf"},"ev",{"VAR?":"typeOf"},{"VAR?":"item"},"?","/ev","~ret",{"#f":1}],"SetQuestState":[{"temp=":"state"},{"temp=":"quest"},"ev",{"VAR?":"state"},"/ev",{"temp=":"quest","re":true},{"#f":1}],"ResetSelectedChoices":["ev",0,"/ev",{"VAR=":"SelectedChoices","re":true},{"#f":1}],"CurrentActor":[{"temp=":"x"},"ev",{"VAR?":"x"},"/ev",{"VAR=":"CurrentSpeaker","re":true},{"#f":1}],"Speaker":["^[b]","\n","ev",{"VAR?":"CurrentSpeaker"},"/ev","~ret",{"#f":1}],"tunnel_as_thread":[{"temp=":"ret"},{"temp=":"tunnel"},[[{"->t->":"tunnel","var":true},"ev",{"^->":"tunnel_as_thread.2.top"},"turns",0,"==","/ev",[{"->":".^.b","c":true},{"b":["^ ","done",{"->":".^.^.^.8"},null]}],"nop","^ ",{"->":"ret","var":true},"\n",{"#f":7,"#n":"top"}],null],{"#f":1}],"Add":[{"temp=":"k"},{"temp=":"x"},"ev",{"VAR?":"x"},{"VAR?":"k"},"+","/ev",{"temp=":"x","re":true},{"#f":1}],"Substract":[{"temp=":"k"},{"temp=":"x"},"ev",{"VAR?":"x"},{"VAR?":"k"},"-","/ev",{"temp=":"x","re":true},{"#f":1}],"AddToUseWith":[{"temp=":"obj"},"ev",{"VAR?":"UseWith"},{"VAR?":"obj"},"+",{"VAR=":"UseWith","re":true},"/ev",{"#f":1}],"ResetUseWith":["ev",{"list":{}},"/ev",{"VAR=":"UseWith","re":true},{"#f":1}],"IsUsing":[{"temp=":"x"},"ev",{"VAR?":"UseWith"},{"VAR?":"x"},"?","/ev","~ret",{"#f":1}],"PlayBGM":[{"temp=":"id"},"ev",1,"/ev","~ret",{"#f":1}],"Level01":[{"->":".^.exterior"},{"exterior":["done",{"#f":1}],"scn_forge":[[["#","^HELLO_WORLD","/#","#","^SHOW_ACTOR","/#","ev","str","^bgm","/str",{"x()":"PlayBGM","exArgs":1},"pop","/ev","\n","ev",{"VAR?":"BLACKSMITH"},{"f()":"CurrentActor"},"pop","/ev","\n","ev",{"VAR?":"Visited"},{"VAR?":"level01.forge"},"!?","/ev",[{"->":".^.b","c":true},{"b":["^ The door is ajar, and you enter. Inside, a tall grey figure is standing near a forge hearth, smiling. ",{"->":".^.^.^.26"},null]}],"nop","\n","ev",{"VAR?":"Visited"},{"VAR?":"level01.forge"},"?","/ev",[{"->":".^.b","c":true},{"b":["^  You push the door gently and enter. Inside, a familiar face is smiling at you. ",{"->":".^.^.^.34"},null]}],"nop","\n",["ev","str","^Overhear Conversation","/str",{"VAR?":"Knowledge"},{"VAR?":"level01scn01.mithren_book"},"!?","/ev",{"*":".^.c-0","flg":5},"ev","str","^Continue to Dialog","/str","/ev",{"*":".^.c-1","flg":4},{"c-0":["^ ",{"->":".^.^.^.^.overhear_conversation"},"\n",{"->":".^.^.^.^.bit03"},{"#f":5}],"c-1":["^                                                ",{"->":".^.^.^.^.bit03"},"\n",{"->":".^.^.^.^.bit03"},{"#f":5}],"#f":5,"#n":"bit02"}],{"#f":5,"#n":"bit01"}],{"bit03":["ev",{"VAR?":"Visited"},{"VAR?":"level01.forge"},"!?","/ev",[{"->":".^.b","c":true},{"b":["^ ","ev",{"f()":"Speaker"},"out","/ev","^[/b]: Hey Nezumi, how may I help ya! ",{"->":".^.^.^.6"},null]}],"nop","\n","ev",{"VAR?":"Visited"},{"VAR?":"level01.forge"},"?","/ev",[{"->":".^.b","c":true},{"b":["^  ","ev",{"f()":"Speaker"},"out","/ev","^[/b]: Welcome back, kiddo! ",{"->":".^.^.^.14"},null]}],"nop","\n","ev",{"VAR?":"level01.forge"},{"f()":"HasVisited"},"pop","/ev","\n",{"->":".^.bit04.ret"},["ev",{"f()":"Speaker"},"out","/ev","^[/b]: Anything else, kiddo?","\n",["ev",{"^->":"Level01.scn_forge.0.bit03.bit04.ret.dialog"},{"^->":"Level01.scn_forge.0.bit03.bit04"},"/ev","thread",{"->":"tunnel_as_thread"},"done",["ev",{"^->":"Level01.scn_forge.0.done.scene_objects"},"/ev",{"VAR=":"continueOnto","re":true},"ev",{"^->":"Level01.scn_forge.0.bit03.bit04"},"/ev",{"VAR=":"returnTo","re":true},"ev",{"f()":"ResetUseWith"},"pop","/ev","\n","ev","str","^What's your name?","/str","/ev",{"*":".^.c-2","flg":20},"ev","str","^What do you do?","/str","/ev",{"*":".^.c-3","flg":20},"ev","str","^I can get your book","/str",{"VAR?":"Knowledge"},{"VAR?":"level01scn01.mithren_book"},"?","/ev",{"*":".^.c-4","flg":21},"ev","str","^I need strawberries","/str",{"VAR?":"Inventory"},{"VAR?":"QuestItem.strawberries"},"!?","/ev",{"*":".^.c-5","flg":21},"ev","str","^I should leave","/str","/ev",{"*":".^.c-6","flg":4},{"c-2":["^                                           ",{"->":".^.^.^.^.^.^.ask_name"},"\n",{"->":".^.^.^.^.^.^.done"},{"#f":5}],"c-3":["^                                             ",{"->":".^.^.^.^.^.^.ask_name.ask_occupation"},"\n",{"->":".^.^.^.^.^.^.done"},{"#f":5}],"c-4":["^ ",{"->":".^.^.^.^.^.^.need_strawberries.offer_help"},"\n",{"->":".^.^.^.^.^.^.done"},{"#f":5}],"c-5":["^ ",{"->":".^.^.^.^.^.^.need_strawberries"},"\n",{"->":".^.^.^.^.^.^.done"},{"#f":5}],"c-6":["^                                              ",{"->":".^.^.^.^.^.^.need_strawberries.offer_help.leave"},"\n",{"->":".^.^.^.^.^.^.done"},{"#f":5}],"#f":7,"#n":"dialog"}],{"#f":5,"#n":"ret"}],{"#f":7,"#n":"bit04"}],{"#f":5}],"done":["ev","void","/ev","->->",["ev","str","^Mithren, the Blacksmith","/str","/ev",{"*":".^.c-7","flg":4},"ev","str","^(CANCEL)","/str","/ev",{"*":".^.c-8","flg":4},{"c-7":["\n","ev",{"VAR?":"Actors.BLACKSMITH"},{"f()":"AddToUseWith"},"pop","/ev","\n",{"->":".^.^.^.^._npc"},{"->":".^.^.^.^._npc"},{"#f":5}],"c-8":["^ ","\n",{"->":".^.^.^.^.bit03.bit04"},{"->":".^.^.^.^._npc"},{"#f":5}],"#f":7,"#n":"scene_objects"}],{"#f":5}],"_npc":["ev",{"VAR?":"QuestItem.baking_pan"},{"f()":"IsUsing"},{"VAR?":"Actors.BLACKSMITH"},{"f()":"IsUsing"},"&&","/ev",[{"->":".^.b","c":true},{"b":["\n","ev",{"f()":"Speaker"},"out","/ev","^[/b]: ",["ev","visit",4,"seq","/ev","ev","du",0,"==","/ev",{"->":".^.s0","c":true},"ev","du",1,"==","/ev",{"->":".^.s1","c":true},"ev","du",2,"==","/ev",{"->":".^.s2","c":true},"ev","du",3,"==","/ev",{"->":".^.s3","c":true},"nop",{"s0":["pop","^ Is there something wrong with the baking-pan? ",{"->":".^.^.29"},null],"s1":["pop","^ Huh? ",{"->":".^.^.29"},null],"s2":["pop","^ I don't have a bag, sorry. ",{"->":".^.^.29"},null],"s3":["pop","^ No refunds, kiddo. Sorry! ",{"->":".^.^.29"},null],"#f":5}],"\n","^The blacksmith seems confused.","\n",{"->":".^.^.^.^.bit03.bit04"},{"->":".^.^.^.8"},null]}],"nop","\n","ev",{"VAR?":"QuestItem.strawberries"},{"f()":"IsUsing"},{"VAR?":"Actors.BLACKSMITH"},{"f()":"IsUsing"},"&&","/ev",[{"->":".^.b","c":true},{"b":["\n","ev",{"f()":"Speaker"},"out","/ev","^[/b]: ",["ev","visit",2,"seq","/ev","ev","du",0,"==","/ev",{"->":".^.s0","c":true},"ev","du",1,"==","/ev",{"->":".^.s1","c":true},"nop",{"s0":["pop","^ Thanks, I'm not hungry! ",{"->":".^.^.17"},null],"s1":["pop","^ Aren't you supposed to bring back those home? ",{"->":".^.^.17"},null],"#f":5}],"\n","^The blacksmith seems confused.","\n",{"->":".^.^.^.^.bit03.bit04"},{"->":".^.^.^.18"},null]}],"nop","\n","ev",{"VAR?":"QuestItem.mithren_book"},{"f()":"IsUsing"},{"VAR?":"Actors.BLACKSMITH"},{"f()":"IsUsing"},"&&","/ev",[{"->":".^.b","c":true},{"b":["\n","ev",{"^var":"Inventory","ci":-1},{"VAR?":"QuestItem.mithren_book"},{"f()":"UseItem"},"pop","/ev","\n","ev",{"^var":"Quest_002","ci":-1},"str","^quest_complete","/str",{"f()":"SetQuestState"},"pop","/ev","\n","ev",{"f()":"Speaker"},"out","/ev","^[/b]: Ah great, thanks! I've been waiting for this book for some time.","\n",{"->":".^.^.^.quest_complete"},{"->":".^.^.^.28"},null]}],"nop","\n","done",["ev","str","^What's this book about?","/str","/ev",{"*":".^.c-9","flg":4},"ev","str","^No problem!","/str","/ev",{"*":".^.c-10","flg":4},{"c-9":["\n","ev",{"f()":"Speaker"},"out","/ev","^[/b]: Oh, well... It's about this old powerful magician and a small group of little ones who save the world!","\n","^You smile, daydreaming about all those adventures.","\n",{"->":".^.^.^.^.bit03.bit04"},{"->":".^.^.^.^.overhear_conversation"},{"#f":5}],"c-10":["\n",{"->":".^.^.^.^.bit03.bit04"},{"->":".^.^.^.^.overhear_conversation"},{"#f":5}],"#f":5,"#n":"quest_complete"}],{"#f":5}],"overhear_conversation":["ev",{"VAR?":"CUSTOMER"},{"f()":"CurrentActor"},"pop","/ev","\n","ev",{"f()":"Speaker"},"out","/ev","^[/b]: Have you received that [b]book[/b] you've been talking about yet?","\n","ev","str","^Continue","/str","/ev",{"*":".^.c-11","flg":20},{"c-11":["^ ","\n",{"->":".^.^.^.g-0"},{"#f":5}],"#f":5}],"g-0":["ev",{"VAR?":"BLACKSMITH"},{"f()":"CurrentActor"},"pop","/ev","\n","ev",{"^var":"Knowledge","ci":-1},{"VAR?":"level01scn01.mithren_book"},{"f()":"Learn"},"pop","/ev","\n","ev",{"f()":"Speaker"},"out","/ev","^[/b]: Oh, no, not yet... Sadly, I have been too busy to go get it at the [b]Library[/b].","\n","ev","str","^Continue","/str","/ev",{"*":".^.c-12","flg":20},{"c-12":["\n",{"->":".^.^.^.bit03"},{"->":".^.^.^.ask_name"},{"#f":5}],"#f":5}],"ask_name":["ev",{"f()":"Speaker"},"out","/ev","^[/b]: Oh, I suppose you forgot. My name is [b]Mithren[/b] the grey.","\n",{"->":".^.^.bit03.bit04"},["ev",{"f()":"Speaker"},"out","/ev","^[/b]: Well, I'm a blacksmith! I forge iron tools of all types.","\n","ev","str","^Interesting!","/str","/ev",{"*":".^.c-13","flg":20},"ev","str","^Oh, ok","/str","/ev",{"*":".^.c-14","flg":20},{"c-13":["^ ","\n","^The blacksmith appears delighted.","\n",{"->":".^.^.^.^.bit03.bit04"},{"->":".^.^.^.^.need_strawberries"},{"#f":5}],"c-14":["^       ","\n","^The blacksmith stares at you, a tad perplexed.","\n",{"->":".^.^.^.^.bit03.bit04"},{"->":".^.^.^.^.need_strawberries"},{"#f":5}],"#f":5,"#n":"ask_occupation"}],{"#f":5}],"need_strawberries":["ev",{"f()":"Speaker"},"out","/ev","^[/b]: Strawberries?! You ain't gonna find that here, little one.","\n","ev",{"f()":"Speaker"},"out","/ev","^[/b]: You should visit the [b]Shopkeeper[/b] â€” I'm sure she has strawberries to sell.","\n",{"->":".^.^.bit03.bit04"},["ev",{"^var":"Quest_002","ci":-1},"str","^quest_active","/str",{"f()":"SetQuestState"},"pop","/ev","\n","ev",{"f()":"Speaker"},"out","/ev","^[/b]: Really? Thank you! You will have to go visit the [b]Bookkeeper[/b].","\n","^You nod, happy to help.","\n",{"->":".^.^.^.bit03.bit04"},["^You bow and politely bid farewell.","\n","ev",{"f()":"Speaker"},"out","/ev","^[/b]: Have a nice day, Nezumi!","\n","^And soon after, the blacksmith returned to his chores while whistling a cheerful melody.","\n","ev",{"VAR?":"Inventory"},{"VAR?":"QuestItem.strawberries"},"?",{"VAR?":"Inventory"},{"VAR?":"QuestItem.baking_pan"},"?","&&","/ev",[{"->":".^.b","c":true},{"b":["\n","ev",{"^var":"Quest_001","ci":-1},"str","^quest_complete","/str",{"f()":"SetQuestState"},"pop","/ev","\n",{"->":".^.^.^.20"},null]}],"nop","\n",{"->":"Level01.exterior"},{"#f":5,"#n":"leave"}],{"#f":5,"#n":"offer_help"}],{"#f":5}]}],{"#f":1}],"#f":1}],"global decl":["ev","str","^","/str",{"VAR=":"CurrentLevel"},{"list":{}},{"VAR=":"Inventory"},{"list":{}},{"VAR=":"Keys"},{"list":{}},{"VAR=":"Spells"},-1,{"VAR=":"LampState"},{"list":{},"origins":["QuestItem"]},{"VAR=":"QuestItem"},{"list":{},"origins":["UniqueItem"]},{"VAR=":"UniqueItem"},{"list":{},"origins":["KeyItem"]},{"VAR=":"KeyItem"},{"list":{},"origins":["Melodies"]},{"VAR=":"Melodies"},{"list":{}},{"VAR=":"Visited"},{"list":{},"origins":["level01"]},{"VAR=":"level01"},"str","^quest_unstarted","/str",{"VAR=":"Quest_001"},"str","^quest_unstarted","/str",{"VAR=":"Quest_002"},"str","^quest_unstarted","/str",{"VAR=":"Quest_003"},"str","^quest_unstarted","/str",{"VAR=":"Quest_004"},"str","^quest_unstarted","/str",{"VAR=":"Quest_005"},0,{"VAR=":"SelectedChoices"},"str","^","/str",{"VAR=":"CurrentSpeaker"},{"list":{"Actors.none":1}},{"VAR=":"Actors"},{"list":{}},{"VAR=":"Knowledge"},{"list":{"level01scn00.nothing":1}},{"VAR=":"level01scn00"},{"list":{"level01scn01.nothing":1}},{"VAR=":"level01scn01"},{"list":{"level01scn02.nothing":1}},{"VAR=":"level01scn02"},{"list":{"level01scn03.nothing":1}},{"VAR=":"level01scn03"},{"list":{}},{"VAR=":"Order"},{"list":{"Pans.none":1}},{"VAR=":"Pans"},"str","^","/str",{"VAR=":"ExternalText"},0,{"VAR=":"Coins"},{"list":{}},{"VAR=":"UseWith"},"str","^","/str",{"VAR=":"returnTo"},"str","^","/str",{"VAR=":"continueOnto"},"/ev","end",null],"#f":1}],"listDefs":{"QuestItem":{"strawberries":1,"baking_pan":2,"mithren_book":3,"family_heirloom":4,"oar_1":5,"oar_2":6},"UniqueItem":{"magic_flute":1,"familiar":2,"lamp":3},"KeyItem":{"copper_key":1,"bronze_key":2,"silver_key":3,"gold_key":4},"Melodies":{"reveal":1,"repair":2},"level01":{"forge":1,"shop":2,"library":3,"shrine":4},"Actors":{"none":1,"BLACKSMITH":2,"CUSTOMER":3,"SHOPKEEPER":4,"SHOPHELPER":5,"BOOKKEEPER":6,"DRIFTER":7,"SAGEOWL":8,"HUSBAND":9,"BARD":10},"level01scn00":{"nothing":1,"tidied_room":2},"level01scn01":{"nothing":1,"mithren_book":2},"level01scn02":{"nothing":1,"give_away":2},"level01scn03":{"nothing":1,"books":2},"Pans":{"none":1,"small":2,"medium":3,"large":4}}}